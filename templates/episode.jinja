{# ========================================================= #}
{# Episode Template                                          #}
{# mode = "script" â†’ renderar fÃ¤rdigt manus (txt)            #}
{# mode = "used"   â†’ skriver bara section_id per rad         #}
{# ========================================================= #}

{% set safe_lang = lang if lang in ["en", "fr", "sw"] else "en" %}
{% set pretty_league = league.replace("_", " ").title() %}

{# Metadata fÃ¶r titlar/beskrivningar per veckodag #}
{% if weekday == 0 %}
  {% set episode_title = pretty_league + " Post-Match â€“ " + date %}
  {% set episode_description = "Weekend roundup of the " + pretty_league + ", with all the top news stories." %}
{% elif weekday == 1 %}
  {% set episode_title = pretty_league + " Daily Recap â€“ " + date %}
  {% set episode_description = "Daily " + pretty_league + " recap, top 3 news, and key African player stats." %}
{% elif weekday == 3 %}
  {% set episode_title = pretty_league + " Daily Highlights â€“ " + date %}
  {% set episode_description = "Highlights and expert opinions from the " + pretty_league + "." %}
{% else %}
  {% set episode_title = pretty_league + " Daily â€“ " + date %}
  {% set episode_description = "Daily recap of the " + pretty_league + "." %}
{% endif %}


{# ========================================================= #}
{# ðŸ§© MODE: SCRIPT â†’ renderar manus                         #}
{# ========================================================= #}
{% if mode == "script" %}

ðŸŽ§ {{ episode_title }}
{{ episode_description }}

{% for sid, sec in sections.items() %}
------------------------------------------------------------
## {{ sid }}
------------------------------------------------------------

{% if sec.text %}
{{ sec.text }}

{% endif %}
{% if sec.lines %}
  {% for l in sec.lines %}
{{ l.persona | capitalize }}: {{ l.text }}
  {% endfor %}
{% endif %}

{% endfor %}
{% endif %}


{# ========================================================= #}
{# ðŸ§© MODE: USED â†’ listar sektioner som ska renderas        #}
{# ========================================================= #}
{% if mode == "used" %}
  {# ------------------------------------------------------- #}
  {# MÃ¥ndag: Post-Match intro + alla NEWS                    #}
  {# ------------------------------------------------------- #}
  {% if weekday == 0 %}
S.GENERIC.INTRO.POSTMATCH
    {% for sid, sec in sections.items() if sid.startswith("S.NEWS.") %}
{{ sid }}
    {% endfor %}
  {# ------------------------------------------------------- #}
  {# Tisdag: Daily intro + Top3 + Stats                      #}
  {# ------------------------------------------------------- #}
  {% elif weekday == 1 %}
S.GENERIC.INTRO.DAILY
S.NEWS.TOP3.GENERIC
S.NEWS.TOP.AFRICAN.PLAYERS
  {# ------------------------------------------------------- #}
  {# Torsdag: Daily intro + Highlight + Expert               #}
  {# ------------------------------------------------------- #}
  {% elif weekday == 3 %}
S.GENERIC.INTRO.DAILY
S.NEWS.CLUB.HIGHLIGHT
S.OPINION.EXPERT.COMMENT
  {% else %}
S.GENERIC.INTRO.DAILY
S.NEWS.TOP3.GENERIC
  {% endif %}
{% endif %}
