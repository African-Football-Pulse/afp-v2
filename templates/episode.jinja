{# ========================================================= #}
{# Episode Template                                          #}
{# mode = "script" → renderar färdigt manus (txt)            #}
{# mode = "used"   → skriver bara section_id per rad         #}
{# ========================================================= #}

{% set safe_lang = lang if lang in ["en", "fr", "sw"] else "en" %}

{% if mode == "used" %}
  {# ------------------------------------------------------- #}
  {# Måndag: Post-Match intro + alla NEWS                    #}
  {# ------------------------------------------------------- #}
  {% if weekday == 0 %}
S.GENERIC.INTRO_POSTMATCH
    {% for sid, sec in sections.items() if sid.startswith("S.NEWS.") %}
{{ sid }}
    {% endfor %}
  {# ------------------------------------------------------- #}
  {# Tisdag: Daily intro + Top3 + Stats                      #}
  {# ------------------------------------------------------- #}
  {% elif weekday == 1 %}
S.GENERIC.INTRO_DAILY
S.NEWS.TOP3
S.STATS.TOP_AFRICAN_PLAYERS
  {# ------------------------------------------------------- #}
  {# Torsdag: Daily intro + Highlight + Expert               #}
  {# ------------------------------------------------------- #}
  {% elif weekday == 3 %}
S.GENERIC.INTRO_DAILY
S.NEWS.CLUB_HIGHLIGHT
S.OPINION.EXPERT_COMMENT
  {# ------------------------------------------------------- #}
  {# Övriga dagar: Daily intro + max 2 NEWS                  #}
  {# ------------------------------------------------------- #}
  {% else %}
S.GENERIC.INTRO_DAILY
    {% set counter = 0 %}
    {% for sid, sec in sections.items() if sid.startswith("S.NEWS.") %}
      {% if counter < 2 %}
{{ sid }}
      {% endif %}
      {% set counter = counter + 1 %}
    {% endfor %}
  {% endif %}
{% else %}
{# ========================================================= #}
{# SCRIPT-LÄGE                                               #}
{# ========================================================= #}

{% if weekday == 0 %}
### {% if safe_lang == "fr" %}Introduction d'après-match{% elif safe_lang == "sw" %}Utangulizi wa Baada ya Mechi{% else %}Post-Match Intro{% endif %}
{{ sections.get("S.GENERIC.INTRO_POSTMATCH", {}).text }}
{% else %}
### {% if safe_lang == "fr" %}Introduction quotidienne{% elif safe_lang == "sw" %}Utangulizi wa Kila Siku{% else %}Daily Intro{% endif %}
{{ sections.get("S.GENERIC.INTRO_DAILY", {}).text }}
{% endif %}

---

{% if weekday == 0 %}
  {% for sid, sec in sections.items() if sid.startswith("S.NEWS.") %}
{{ sec.text }}

---
  {% endfor %}
{% elif weekday == 1 %}
{{ sections.get("S.NEWS.TOP3", {}).text }}

---

{{ sections.get("S.STATS.TOP_AFRICAN_PLAYERS", {}).text }}
{% elif weekday == 3 %}
{{ sections.get("S.NEWS.CLUB_HIGHLIGHT", {}).text }}

---

{{ sections.get("S.OPINION.EXPERT_COMMENT", {}).text }}
{% else %}
  {% set counter = 0 %}
  {% for sid, sec in sections.items() if sid.startswith("S.NEWS.") %}
    {% if counter < 2 %}
{{ sec.text }}

---
    {% endif %}
    {% set counter = counter + 1 %}
  {% endfor %}
{% endif %}
{% endif %}
